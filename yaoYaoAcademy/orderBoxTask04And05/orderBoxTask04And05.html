<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div class="container">
    <div class="table-wrapper">
        <table>
            <tr>
                <td>
                    <div id="box"></div>
                </td>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                <td>5</td>
                <td>6</td>
                <td>7</td>
                <td>8</td>
                <td>9</td>
                <td>10</td>
            </tr>
            <tr>
                <td>1</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>2</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>3</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>4</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>5</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>6</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>7</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>8</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>9</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>10</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>
        <div class="submit-wrapper">
            <label for="">
                <input id="input-action" type="text" class="form-control">
            </label>
            <button id="submit-action" class="btn">执行</button>
        </div>
        </div>
        <div class="ol-wrapper">
        <ol>
            <li>GO：向蓝色边所面向的方向前进一格（一格等同于正方形的边长）</li>
            <li>TUNLEF：向左转（逆时针旋转90度）</li>
            <li>TUNRIG：向右转（顺时针旋转90度）</li>
            <li>TUNBAC：向右转（旋转180度）</li>
            <li>TRALEF：向屏幕的左侧移动一格，方向不变</li>
            <li>TRATOP：向屏幕的上面移动一格，方向不变</li>
            <li>TRARIG：向屏幕的右侧移动一格，方向不变</li>
            <li>TRABOT：向屏幕的下面移动一格，方向不变</li>
            <li>MOVLEF：方向转向屏幕左侧，并向屏幕的左侧移动一格</li>
            <li>MOVTOP：方向转向屏幕上面，向屏幕的上面移动一格</li>
            <li>MOVRIG：方向转向屏幕右侧，向屏幕的右侧移动一格</li>
            <li>MOVBOT：方向转向屏幕下面，向屏幕的下面移动一格</li>
        </ol>
        </div>
    </div>
    <script type="text/javascript">
    

    //box相关参数，左上角为原点
    let cur = {
        'x': 200, //x轴离原点距离
        'y': 200, //y轴离原点距离
        'change': 40, //每次变化的值，可能值为40，-40
        'width': 40, //td宽度
        'rotate': 0, //旋转角度
        'topOrLeft': 'left', //左上角为原点，和change的正负值一起用于判断往哪走
        'direction': 'right' //方块当前方向

    };
    //四个方向
    const directionArr = ['top', 'right', 'bottom', 'left'];

    //提交按钮
    let submitAction = document.getElementById('submit-action');
    submitAction.onclick = () => {
        let inputAction = document.getElementById('input-action').value;
        let box = document.getElementById('box');

        // console.log(cur);
        switch (inputAction) {
            case 'GO':
                {
                    //x轴没出界
                    if ((cur.topOrLeft == 'left' && cur.change == cur.width && cur.x < cur.width * 10) ||
                        (cur.topOrLeft == 'left' && cur.change == -cur.width && cur.x > cur.width)
                    ) {
                        box.style[cur.topOrLeft] = cur.x + cur.change + 'px';
                        cur.x += cur.change;
                    } else if ((cur.topOrLeft == 'top' && cur.change == cur.width && cur.y < cur.width * 10) ||
                        (cur.topOrLeft == 'top' && cur.change == -cur.width && cur.y > cur.width)) {
                        //y轴没出界
                        box.style[cur.topOrLeft] = cur.y + cur.change + 'px';
                        cur.y += cur.change;
                    } else {
                        //出界
                        alert('出界了');
                    }
                }
                break;
            case 'TUNLEF':
                {
                    cur.rotate -= 90;
                    box.style.transform = 'rotate(' + cur.rotate + 'deg)';
                    cur.topOrLeft == 'left' ? cur.topOrLeft = 'top' : cur.topOrLeft = 'left';

                    //求出旋转后的方向
                    let dir;
                    directionArr.forEach((e, i) =>
                        e == cur.direction ? (i === 0 ? dir = directionArr[3] : dir = directionArr[i - 1]) : '');

                    //改变cur.change，左上角为原点，判断下一步往哪走
                    cur.direction = dir;
                    cur.change = judgeChangValue();
                }
                break;
            case 'TUNRIG':
                {
                    cur.rotate += 90;
                    box.style.transform = 'rotate(' + cur.rotate + 'deg)';
                    cur.topOrLeft == 'left' ? cur.topOrLeft = 'top' : cur.topOrLeft = 'left';

                    //求出旋转后的方向
                    let dir;
                    directionArr.forEach((e, i) =>
                        e == cur.direction ? (i === directionArr.length - 1 ? dir = directionArr[0] : dir = directionArr[i + 1]) : ''
                    );

                    //改变cur.change，左上角为原点，判断下一步往哪走
                    cur.direction = dir;
                    cur.change = judgeChangValue();

                }
                break;
            case 'TUNBAC':
                {

                    cur.rotate += 180;
                    box.style.transform = 'rotate(' + cur.rotate + 'deg)';
                    let dir;
                    directionArr.forEach((e, i) => {
                        if (e == cur.direction) {
                            if (i + 2 >= directionArr.length) {
                                dir = directionArr[i + 2 - directionArr.length];
                            } else {
                                dir = directionArr[i + 2];
                            }
                        }
                    });
                    cur.direction = dir;
                    cur.change = judgeChangValue();
                }
                break;

            case 'TRALEF':
                cur.x > cur.width ? (cur.x -= cur.width, box.style[cur.topOrLeft] = cur.x + 'px') : alert('出界了');
                break;
            case 'TRATOP':
                cur.y > cur.width ? (cur.y -= cur.width, box.style.top = cur.y + 'px') : alert('出界了');
                break;
            case 'TRARIG':
                cur.x < cur.width * 10 ? (cur.x += cur.width, box.style[cur.topOrLeft] = cur.x + 'px') : alert('出界了');
                break;
            case 'TRABOT':
                cur.y < cur.width * 10 ? (cur.y += cur.width, box.style.top = cur.y + 'px') : alert('出界了');
                break;

            case 'MOVLEF':
                {
                    if (cur.x > cur.width) {
                        cur.rotate = 180;
                        box.style.transform = 'rotate(' + cur.rotate + 'deg)';
                        cur.topOrLeft = 'left';
                        cur.direction = 'left';
                        cur.x -= cur.width;
                        box.style.left = cur.x + 'px';
                    } else {
                    	alert('出界了');
                    }
                }
                break;
            case 'MOVTOP':
                {
                    if (cur.y > cur.width) {
                        cur.rotate = -90;
                        box.style.transform = 'rotate(' + cur.rotate + 'deg)';
                        cur.topOrLeft = 'top';
                        cur.direction = 'top';
                        cur.y -= cur.width;
                        box.style.top = cur.y + 'px';
                    } else {
                    	alert('出界了');
                    }
                }
                break;
            case 'MOVRIG':
                {
                    if (cur.x < cur.width*10) {
                        cur.rotate = 0;
                        box.style.transform = 'rotate(' + cur.rotate + 'deg)';
                        cur.topOrLeft = 'left';
                        cur.direction = 'right';
                        cur.x += cur.width;
                        box.style.left = cur.x + 'px';
                    } else {
                    	alert('出界了');
                    }
                }
                break;
            case 'MOVBOT':
                {
                    if (cur.y < cur.width*10) {
                        cur.rotate = 90;
                        box.style.transform = 'rotate(' + cur.rotate + 'deg)';
                        cur.topOrLeft = 'top';
                        cur.direction = 'bottom';
                        cur.y += cur.width;
                        box.style.top = cur.y + 'px';
                    } else {
                    	alert('出界了');
                    }
                }
                break;
        }

    };

    //求得cur.change的值
    function judgeChangValue() {
        let change;
        cur.direction == 'top' || cur.direction == 'left' ? change = -cur.width : change = cur.width;
        return change;
    }

    // function turnDirection(className) {
    //     [].slice.call(document.querySelectorAll('div.read')).map((i) => i.classList.add(className));
    // }
    </script>
</body>

</html>
